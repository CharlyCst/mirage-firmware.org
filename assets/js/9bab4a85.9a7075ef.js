"use strict";(self.webpackChunkwebsite_miralis=self.webpackChunkwebsite_miralis||[]).push([[515],{9786:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>c});var n=i(4848),o=i(8453);const r={},s="Tooling",a={id:"Developer/tooling",title:"Tooling",description:"To make development easier and faster the Miralis project relies on a set of custom tools.",source:"@site/docs/Developer/tooling.md",sourceDirName:"Developer",slug:"/Developer/tooling",permalink:"/docs/Developer/tooling",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Terminology",permalink:"/docs/Developer/terminology"}},l={},c=[{value:"Configuration",id:"configuration",level:2},{value:"Test Artifacts",id:"test-artifacts",level:2}];function d(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",p:"p",...(0,o.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{id:"tooling",children:"Tooling"}),"\n",(0,n.jsxs)(t.p,{children:["To make development easier and faster the Miralis project relies on a set of custom tools.\nThe main tool is the ",(0,n.jsx)(t.code,{children:"runner"}),", which indeed started as a simple runner and build tool but whose scope has been extended over time."]}),"\n",(0,n.jsx)(t.h2,{id:"configuration",children:"Configuration"}),"\n",(0,n.jsxs)(t.p,{children:["Miralis uses ",(0,n.jsx)(t.a,{href:"https://toml.io/",children:"toml"})," for configuration.\nPre-defined configurations can be found in the ",(0,n.jsx)(t.code,{children:"./config"})," directory.\nIn particular, the ",(0,n.jsx)(t.code,{children:"./config/example.config.toml"})," list the valid configuration fields with explanatory comments."]}),"\n",(0,n.jsxs)(t.p,{children:["The Miralis build tool will by default look for a configuration named ",(0,n.jsx)(t.code,{children:"config.toml"})," at the root of this repository (this file is ignored by the ",(0,n.jsx)(t.code,{children:".gitignore"}),", so that each developer can keep its own), but there are default value for every field in case none is found.\nUsing a custom ",(0,n.jsx)(t.code,{children:"config.toml"})," file is recommended for developing and debugging, it exposes utilities such as configuring the log level (globally or on a per-module basis) and limiting the maximum number of firmware traps to prevent infinite loops."]}),"\n",(0,n.jsxs)(t.p,{children:["Configurations are especially important when building for a particular platform.\nThe ",(0,n.jsx)(t.code,{children:"just build"})," command takes a configuration as argument for instance, from which the appropriate platform will be selected (for instance ",(0,n.jsx)(t.code,{children:"visionfive2"})," or ",(0,n.jsx)(t.code,{children:"qemu_virt"}),")."]}),"\n",(0,n.jsx)(t.h2,{id:"test-artifacts",children:"Test Artifacts"}),"\n",(0,n.jsxs)(t.p,{children:["In addition to writing our own test firmware, we test Miarge against third party projects.\nBut because it would be inconvenient for developers (and expensive on the CI) to build all third-party projects from source, our runner can download pre-compiled binaries that can be used for testing.\nAvailable artifacts are described in an artifact manifest located at ",(0,n.jsx)(t.code,{children:"mist/artifacts.toml"}),".\nThe manifest is a ",(0,n.jsx)(t.a,{href:"https://toml.io/",children:"toml"})," file that lists artifacts in the ",(0,n.jsx)(t.code,{children:"[bin]"})," section with their corresponding download URL."]}),"\n",(0,n.jsxs)(t.p,{children:["We externalize the build of artifacts to other repositories, so that we don't need to build them for each commit on the CI.\nFor instance, our test version of OpenSBI is built ",(0,n.jsx)(t.a,{href:"https://github.com/CharlyCst/miralis-artifact-opensbi",children:"here"}),".\nThose repos then expose artifacts as binary through releases, whose download link can be added to the artifact manifest."]}),"\n",(0,n.jsxs)(t.p,{children:["When using ",(0,n.jsx)(t.code,{children:"just run opensbi"})," the runner will check if we have a custom firmware in a crate named ",(0,n.jsx)(t.code,{children:"opensbi"}),", and because that is not the case it will look-up the artifact manifest.\nWe do have an artifact named ",(0,n.jsx)(t.code,{children:"opensbi"}),", so the runner will check if it is already downloaded, and download it if that is not the case (or if the artifact manifest has been updated since then)."]})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},8453:(e,t,i)=>{i.d(t,{R:()=>s,x:()=>a});var n=i(6540);const o={},r=n.createContext(o);function s(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);